@model ChangeRightsViewModel

<form asp-controller="Role" asp-action="ChangeSelectedRole" method="post">
	<select name="SelectedRoleId" onchange="this.form.submit()">
		@foreach (Role role in Model.Roles)
		{
			if(role.id == Model.SelectedRole.id)
			{
				<option value="@role.id" selected>@role.name</option>
			} else
			{
				<option value="@role.id">@role.name</option>
			}
		}
	</select>
</form>

<form asp-controller="Role" asp-action="changeRights">
	@if (Model.SelectedRole != null)
	{
		for (int i = 0; i < Model.Rights.Count; i++)
		{
			bool hasRight = false;

			foreach (Right roleRight in Model.SelectedRole.Rights)
			{
				if (Model.Rights[i].id == roleRight.id)
				{
					hasRight = true;
				}
			}

			if (hasRight)
			{
				@Model.Rights[i].name <input name="selectedRights" value="@Model.Rights[i].id" type="checkbox" checked /><br />
			}
			else
			{
				@Model.Rights[i].name <input name="selectedRights" value="@Model.Rights[i].id" type="checkbox" /><br />
			}
		}
	}

	<input type="text" name="SelectedRoleId" value="@Model.SelectedRole.id" style="display:none;"/>
	<input type="submit" name="submit"/>
</form>